!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Liqvid.Utils.misc"),require("Liqvid"),require("React")):"function"==typeof define&&define.amd?define(["Liqvid.Utils.misc","Liqvid","React"],t):"object"==typeof exports?exports.Liqvid_XyJax=t(require("Liqvid.Utils.misc"),require("Liqvid"),require("React")):e.Liqvid_XyJax=t(e["Liqvid.Utils.misc"],e.Liqvid,e.React)}(self,((e,t,r)=>(()=>{"use strict";var o={290:e=>{e.exports=t},517:t=>{t.exports=e},24:e=>{e.exports=r}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var r=n[e]={exports:{}};return o[e](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{i.r(a),i.d(a,{extendXY:()=>s,fromb52:()=>d,tob52:()=>p,useAnimateArrows:()=>o,xyDecodeColor:()=>l,xyEncodeColor:()=>u});var e=i(517),t=i(290),r=i(24);function o(o,n){const i=(0,t.usePlayback)(),a=(0,r.useRef)(),s=(0,r.useRef)({}),c=(0,r.useCallback)((t=>{if(!a.current)return;const{x1:r,x2:o,y1:n,y2:i}=s.current;0===t?a.current.style.opacity="0":(a.current.style.opacity="1",a.current.setAttribute("x2",(0,e.lerp)(r,o,t).toString()),a.current.setAttribute("y2",(0,e.lerp)(n,i,t).toString()))}),[]);(0,r.useEffect)((()=>{o.ref.current.ready.then((()=>{a.current=o.ref.current.domElement.querySelector(o.tail);for(const r of["x1","y1","x2","y2"])s.current[r]=parseFloat(a.current.getAttribute(r));c(o.tailFn(i.currentTime));const e=Array.from(o.ref.current.domElement.querySelectorAll(o.head));for(const r of e)i.newAnimation([{opacity:0},{opacity:1}],o.headFade)(r);const t=Array.from(o.ref.current.domElement.querySelectorAll(o.label));for(const r of t)i.newAnimation([{opacity:0},{opacity:1}],o.labelFade)(r)}))}),n),(0,t.useTime)(c,o.tailFn,n)}let n=!1;function s(){const e=MathJax.AST,t=MathJax.xypicGlobalContext,{modifierRepository:r}=t.repositories,o=e.Modifier.Shape.Alphabets.prototype,n=o.preprocess.bind(o);o.preprocess=function(...e){return this.alphabets.startsWith("color")?r.get("color").preprocess(...e):this.alphabets.startsWith("data")?r.get("data").preprocess(...e):n(...e)};const i=o.modifyShape.bind(o);o.modifyShape=function(...e){if(this.alphabets.startsWith("color")){const t=this.alphabets.substr("color".length);return r.get("color").modifyShape(...e,t)}if(this.alphabets.startsWith("data")){const t=this.alphabets.substr("data".length);return r.get("data").modifyShape(...e,t)}return i(...e)},r.put("color",new class extends e.Modifier.Shape.ChangeColor{modifyShape(e,t,r,o){return this.colorName=l(o),super.modifyShape(e,t,r)}});class a{data;shape;constructor(e,t){this.data=e,this.shape=t}draw(e){const t=e.createGroup();Object.assign(t.drawArea.dataset,JSON.parse("{"+d(this.data)+"}")),this.shape.draw(t)}getBoundingBox(){return this.shape.getBoundingBox()}}r.put("data",new class extends e.Modifier{preprocess(){}modifyShape(e,t,r,o){return t=this.proceedModifyShape(e,t,r),new a(o,t)}})}Object.defineProperty(MathJax,"AST",{get(){return this.__xypic},set(e){return this.__xypic=e,n||(s(),n=!0),this.__xypic=e}});const c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function u(e){return e.toUpperCase().replace(/[#0-9]/g,(e=>"#"===e?"":String.fromCharCode("G".charCodeAt(0)+parseInt(e))))}function l(e){return"#"+e.replace(/[G-P]/g,(e=>(e.charCodeAt(0)-"G".charCodeAt(0)).toString()))}function p(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r);return function(e,t){let r,o,n,i=[],a="";for(let s=0;s<e.length;++s)for(r=0,o=e[s],a+=o||a.length^s?"":1;r in i||o;)n=i[r],n=n?256*n+o:o,o=n/t.length|0,i[r]=n%t.length,r++;for(;r--;)a+=t[i[r]];return a}(new Uint8Array(t),c)}function d(e){const t=function(e,t){let r,o,n,i=[],a=[];for(let s=0;s<e.length;++s){if(r=0,o=t.indexOf(e[s]),o<0)return;for(o||a.length^s||a.push(0);r in i||o;)n=i[r],n=n?n*t.length+o:o,o=n>>8,i[r]=n%256,r++}for(;r--;)a.push(i[r]);return new Uint8Array(a)}(e,c);let r="";for(let o=0;o<t.length;++o)r+=String.fromCharCode(t[o]);return r}})(),a})()));