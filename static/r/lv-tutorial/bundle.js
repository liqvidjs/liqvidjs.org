(()=>{"use strict";var e={534:e=>{var t=.1,r="function"==typeof Float32Array;function n(e,t){return 1-3*t+3*e}function s(e,t){return 3*t-6*e}function o(e){return 3*e}function i(e,t,r){return((n(t,r)*e+s(t,r))*e+o(t))*e}function a(e,t,r){return 3*n(t,r)*e*e+2*s(t,r)*e+o(t)}function c(e){return e}e.exports=function(e,n,s,o){if(!(0<=e&&e<=1&&0<=s&&s<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===n&&s===o)return c;for(var l=r?new Float32Array(11):new Array(11),u=0;u<11;++u)l[u]=i(u*t,e,s);function p(r){for(var n=0,o=1;10!==o&&l[o]<=r;++o)n+=t;--o;var c=n+(r-l[o])/(l[o+1]-l[o])*t,u=a(c,e,s);return u>=.001?function(e,t,r,n){for(var s=0;s<4;++s){var o=a(t,r,n);if(0===o)return t;t-=(i(t,r,n)-e)/o}return t}(r,c,e,s):0===u?c:function(e,t,r,n,s){var o,a,c=0;do{(o=i(a=t+(r-t)/2,n,s)-e)>0?r=a:t=a}while(Math.abs(o)>1e-7&&++c<10);return a}(r,n,n+t,e,s)}return function(e){return 0===e?0:1===e?1:i(p(e),n,o)}}},212:(e,t,r)=>{var n,s,o;self,e.exports=(n=r(363),s=r(881),o=r(341),(()=>{var e={926:e=>{function t(e,t,r,n,s,o,i){try{var a=e[o](i),c=a.value}catch(l){return void r(l)}a.done?t(c):Promise.resolve(c).then(n,s)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(s,o){var i=e.apply(r,n);function a(e){t(i,s,o,a,c,"next",e)}function c(e){t(i,s,o,a,c,"throw",e)}a(void 0)}))}}},154:e=>{function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t.apply(this,arguments)}e.exports=t},757:(e,t,r)=>{e.exports=r(666)},666:e=>{var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",i=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(U){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var s=t&&t.prototype instanceof y?t:y,o=Object.create(s.prototype),i=new P(n||[]);return o._invoke=function(e,t,r){var n=p;return function(s,o){if(n===d)throw new Error("Generator is already running");if(n===m){if("throw"===s)throw o;return M()}for(r.method=s,r.arg=o;;){var i=r.delegate;if(i){var a=C(i,r);if(a){if(a===f)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?m:h,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=m,r.method="throw",r.arg=c.arg)}}}(e,r,i),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(U){return{type:"throw",arg:U}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",m="completed",f={};function y(){}function g(){}function v(){}var b={};b[o]=function(){return this};var E=Object.getPrototypeOf,w=E&&E(E(R([])));w&&w!==r&&n.call(w,o)&&(b=w);var x=v.prototype=y.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(s,o,i,a){var c=u(e[s],e,o);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,i,a)}),(function(e){r("throw",e,i,a)})):t.resolve(p).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,a)}))}a(c.arg)}var s;this._invoke=function(e,n){function o(){return new t((function(t,s){r(e,n,t,s)}))}return s=s?s.then(o,o):o()}}function C(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,C(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var s=u(n,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,f;var o=s.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function R(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,i=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:M}}function M(){return{value:t,done:!0}}return g.prototype=x.constructor=v,v.constructor=g,g.displayName=c(v,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,a,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},k(O.prototype),O.prototype[i]=function(){return this},e.AsyncIterator=O,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new O(l(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(x),c(x,a,"Generator"),x[o]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=R,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var s=n.arg;S(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=t}catch(o){Function("r","regeneratorRuntime = r")(t)}},916:function(e,t,r){var n,s;"undefined"!=typeof self&&self,e.exports=(n=r(888),s=r(576),(()=>{var e={281:(e,t,r)=>{r.r(t),r.d(t,{CodeEditor:()=>o,CodeReplay:()=>c});var n=r(888),s=r(576);{const e=document.createElement("style");e.type="text/css",document.head.appendChild(e),e.sheet.insertRule(".CodeMirror [contenteditable]{-webkit-user-select: text;user-select: text;}",0)}class o extends n.Component{constructor(e,t){super(e,t),this.player=t,this.ready=new Promise((e=>{this.setReady=e}))}async componentDidMount(){const e=Object.assign({indentUnit:4,lineNumbers:!0,tabSize:4},(t=this.props,["mode","readOnly","theme"].map((e=>e in t?{[e]:t[e]}:{})).reduce(((e,t)=>Object.assign(e,t)),{})));var t;this.editor=window.CodeMirror((e=>{this.placeholder.parentNode.replaceChild(e,this.placeholder)}),e);const r=this.editor.getWrapperElement();Object.assign(r.style,this.props.style);const n=this.props.className?this.props.className.split(" "):[];for(const s of n)r.classList.add(s);r.addEventListener("mouseup",s.Player.preventCanvasClick),this.editor.on("keydown",((e,t)=>{t.key.match(/^[A-Z]$/i)&&this.props.hint&&this.editor.showHint({hint:this.props.hint,completeSingle:!1,customKeys:{Down:(e,t)=>t.moveFocus(1),Up:(e,t)=>t.moveFocus(-1),Tab:(e,t)=>t.pick()}})})),this.editor.on("focus",(()=>{this.props.readOnly||this.player.suspendKeyCapture()})),this.editor.on("blur",(()=>{this.props.readOnly||this.player.resumeKeyCapture()})),this.editor.addKeyMap({Tab(e){const t=Array(e.getOption("indentUnit")+1).join(" ");e.getDoc().replaceSelection(t)}}),this.editor.addKeyMap(this.props.keyMap),this.setReady()}shouldComponentUpdate(e){if(!this.editor)return;const t=this.editor.getWrapperElement().style;for(const r in this.props.style)e.hasOwnProperty(r)||t.removeProperty(r.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`)));return Object.assign(t,e.style),!1}render(){return n.createElement("div",{ref:e=>this.placeholder=e})}}o.contextType=s.Player.Context,o.defaultProps={keyMap:{},readOnly:!1,style:{}};const{bind:i}=s.Utils.misc,{parseTime:a}=s.Utils.time;class c extends n.Component{constructor(e,t){super(e,t),this.player=t,i(this,["blinkCursor","onTimeUpdate","poll"]),"string"==typeof e.start?e.start.match(/^(?:(?:(\d+):)?(\d+):)?(\d+)(?:\.(\d+))?$/)?this.start=a(e.start):this.start=this.player.script.markerByName(e.start)[1]:this.start=e.start,this.i=0,this.lastTime=0,this.cursorState={line:0,ch:0},this.broadcast=e.broadcast,this.replay=this.props.replay,this.times=this.replay.map((e=>e[0]));for(let r=1;r<this.times.length;++r)this.times[r]+=this.times[r-1];0!==this.replay.length&&(this.duration=this.times[this.times.length-1])}async poll(e){this.replay.push(...e);let t=0===this.times.length?0:this.times[this.times.length-1];for(const[r]of e)this.times.push(t+r),t+=r;this.duration=this.times[this.times.length-1]}componentDidMount(){const{playback:e}=this.player;e.hub.on("seek",this.onTimeUpdate),e.hub.on("timeupdate",this.onTimeUpdate),this.codeEditor.ready.then((()=>{const e=this.codeEditor.editor,t=e.getWrapperElement().querySelector(".CodeMirror-cursors");this.cursorDiv=p('\n        <div class="CodeMirror-cursors">\n          <div class="CodeMirror-cursor"> </div>\n        </div>\n      '),this.cursor=this.cursorDiv.firstElementChild,t.parentNode.replaceChild(this.cursorDiv,t),this.setCursor(this.getCursor()),setInterval(this.blinkCursor,e.getOption("cursorBlinkRate")),this.selectionsDiv=p('<div style="position: relative;z-index: 1;"/>'),this.cursorDiv.parentNode.insertBefore(this.selectionsDiv,this.cursorDiv)}))}onTimeUpdate(e){const t=e-this.start,r=this.codeEditor.editor;if(!r)return;const n={cursor:this.getCursor(),selection:r.getDoc().listSelections()[0],value:r.getValue().split("\n")},s=this.i;if(this.lastTime<=e&&this.i<this.replay.length){let e=this.i;for(;e<this.replay.length&&this.times[e]<=t;++e){const[,[t,r]]=this.replay[e];this.fwd({type:t,data:r,state:n})}this.i=e}else if(e<this.lastTime&&0<this.i){let e=this.i-1;for(;0<=e&&t<this.times[e];--e){const[,[t,r]]=this.replay[e];this.back({type:t,data:r,state:n})}this.i=e+1}if(this.i!==s){const{left:e,top:t}=r.getScrollInfo(),s=r.getDoc().listSelections()[0];r.setValue(n.value.join("\n")),this.setSelection(n.selection.anchor,n.selection.head),this.setCursor(n.cursor),r.getDoc().setSelection(s.anchor,s.head),r.scrollTo(e,t)}this.lastTime=e}fwd(e){switch(e.type){case"command":this.props.command("fwd",e.data,e.state);break;case"cursor":e.state.cursor=e.data;break;case"selection":e.state.selection=e.data;break;case"text":l(e.state.value,e.data.text,e.data.from,e.data.to)}}back(e){switch(e.type){case"command":this.props.command("back",e.data,e.state);break;case"cursor":break;case"text":const t={line:e.data.from.line,ch:e.data.from.ch},r={line:e.data.from.line+e.data.text.length-1,ch:1===e.data.text.length?e.data.from.ch+e.data.text[0].length:e.data.text[e.data.text.length-1].length};l(e.state.value,e.data.removed,t,r)}}blinkCursor(){this.cursorDiv.style.visibility="hidden"===this.cursorDiv.style.visibility?"visible":"hidden"}getCursor(){return this.cursorState}setCursor({line:e,ch:t}){const r=this.codeEditor.editor,n=r.cursorCoords({line:e,ch:t},"div"),s=Math.max(0,n.bottom-n.top)*r.getOption("cursorHeight");Object.assign(this.cursor.style,{left:`${n.left}px`,top:`${n.top}px`,height:`${s}px`}),this.cursorState={line:e,ch:t}}setSelection(e,t){const r=this.codeEditor.editor;for(;this.selectionsDiv.firstChild;)this.selectionsDiv.lastChild.remove();const n=r.cursorCoords(e,"div"),s=r.cursorCoords(t,"div"),o=r.cursorCoords({line:0,ch:0},"div"),i=Math.max(0,n.bottom-n.top)*r.getOption("cursorHeight"),a=r.getWrapperElement().getBoundingClientRect().width;for(let l=e.line;l<=t.line;++l){const r=n.top+(l-e.line)*i,u=(l===e.line?n:o).left;let p;p=l===e.line?e.line===t.line?s.left-n.left:a-n.left:l===t.line?s.left-o.left:a;const h=c(u,r,p,i);this.selectionsDiv.appendChild(h)}function c(e,t,r,n){const s=p('<div class="CodeMirror-selected" style="position: absolute;"></div>');return Object.assign(s.style,{left:`${e}px`,top:`${t}px`,width:`${r}px`,height:`${n}px`}),s}}render(){const e=(t=this.props,["className","mode","style","theme"].map((e=>e in t?{[e]:t[e]}:{})).reduce(((e,t)=>Object.assign(e,t)),{}));var t;return n.createElement(o,Object.assign({ref:e=>this.codeEditor=e,readOnly:!0},e))}}function l(e,t,r,n){r=u(e,r),n=u(e,n);const s=e[r.line].slice(0,r.ch),o=e[n.line].slice(n.ch,e[n.line].length),i=1===t.length?[s+t[0]+o]:[s+t[0],...t.slice(1,t.length-1),t[t.length-1]+o];e.splice(r.line,n.line-r.line+1,...i)}function u(e,t){const r=e.length-1;return t.line>r?{line:r,ch:e[r].length}:function(e,t){return null==e.ch||e.ch>t?{line:e.line,ch:t}:e.ch<0?{line:e.line,ch:0}:e}(t,e[t.line].length)}function p(e){const t=document.createElement("template");return t.innerHTML=e,t.content.cloneNode(!0).firstElementChild}c.contextType=s.Player.Context,c.defaultProps={replay:[]}},576:e=>{e.exports=s},888:e=>{e.exports=n}},t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(281)})())},996:(e,t,r)=>{r.r(t),r.d(t,{CodeBooth:()=>m});var n=r(888),s=r(742),o=r(916);function i(e){let t;const r=new Set,n=(e,n)=>{const s="function"==typeof e?e(t):e;if(s!==t){const e=t;t=n?s:Object.assign({},t,s),r.forEach((r=>r(t,e)))}},s=()=>t,o={setState:n,getState:s,subscribe:(e,n,o)=>n||o?((e,n=s,o=Object.is)=>{let i=n(t);function a(){const r=n(t);if(!o(i,r)){const t=i;e(i=r,t)}}return r.add(a),()=>r.delete(a)})(e,n,o):(r.add(e),()=>r.delete(e)),destroy:()=>r.clear()};return t=e(n,s,o),o}const a="undefined"==typeof window?n.useEffect:n.useLayoutEffect,c=function(e){const t="function"==typeof e?i(e):e,r=(e=t.getState,r=Object.is)=>{const[,s]=(0,n.useReducer)((e=>e+1),0),o=t.getState(),i=(0,n.useRef)(o),c=(0,n.useRef)(e),l=(0,n.useRef)(r),u=(0,n.useRef)(!1),p=(0,n.useRef)();let h;void 0===p.current&&(p.current=e(o));let d=!1;(i.current!==o||c.current!==e||l.current!==r||u.current)&&(h=e(o),d=!r(p.current,h)),a((()=>{d&&(p.current=h),i.current=o,c.current=e,l.current=r,u.current=!1}));const m=(0,n.useRef)(o);return a((()=>{const e=()=>{try{const e=t.getState(),r=c.current(e);l.current(p.current,r)||(i.current=e,p.current=r,s())}catch(e){u.current=!0,s()}},r=t.subscribe(e);return t.getState()!==m.current&&e(),r}),[]),d?h:p.current};return Object.assign(r,t),r[Symbol.iterator]=function*(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4"),yield r,yield t},r}((0,r(316).$e)({messages:[],mode:"javascript",pane:"replay"},(e=>({})))),{dragHelperReact:l}=s.Utils.interactivity,{constrain:u}=s.Utils.misc;function p(){const e=c((e=>e.messages)),t=(0,n.useRef)(),r=(0,n.useMemo)((()=>l(((e,{x:r})=>{const n=t.current.parentElement,s=n.getBoundingClientRect();n.style.setProperty("--split",100*u(.25,(r-s.left)/s.width,.75)+"%")}))),[]);return n.createElement("pre",{className:"rp-codebooth-output",onMouseUp:s.Player.preventCanvasClick,ref:t},["ew"].map((e=>n.createElement("div",Object.assign({key:e},r,{className:`ui-resizable-handle ui-resizable-${e}`,style:{zIndex:90}})))),e.map(((e,t)=>n.createElement("span",{key:t,className:e.classNames.join(" ")},e.text))))}var h=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};const{onClick:d}=s.Utils.mobile;function m(e){const{interpreter:t,mode:r,recorder:i,replay:a,start:l,theme:u}=e,m=h(e,["interpreter","mode","recorder","replay","start","theme"]),f=(0,n.useRef)(),y=(0,n.useRef)(),g=c((e=>e.pane));i&&(0,n.useEffect)((()=>{y.current.ready.then((()=>{i.connect(y.current)}))}),[]);const v=(0,n.useCallback)((e=>{const t=e.currentTarget.classList.contains("button-replay")?"replay":"playground";c.setState({pane:t})}),[]),b=(0,n.useCallback)((e=>{y.current.editor.setValue(f.current.codeEditor.editor.getValue())}),[]),E=(0,n.useCallback)(((e,r,n)=>{if("fwd"===e)if("Cmd-Enter"===r||"Ctrl-Enter"===r){const e=n.value.join("\n");let r;try{const n=t.runSync(e);r=n.map((e=>({classNames:["replay"],text:e})))}catch(s){r=s.args?[{classNames:["replay","error"],text:s.args.v[0].v+"\n"}]:[{classNames:["replay","error"],text:s+"\n"}]}c.setState((e=>({messages:e.messages.concat(r)})))}else"Cmd-K"===r&&c.setState((e=>({messages:e.messages.filter((e=>!e.classNames.includes("replay")))})))}),[]),w=(0,n.useCallback)((async e=>{const r="replay"===c.getState().pane?f.current.codeEditor.editor:y.current.editor;let n;try{const e=await t.run(r.getValue());n=e.map((e=>({classNames:["user"],text:e})))}catch(e){console.log(e),n=e.args?[{classNames:["user","error"],text:e.args.v[0].v+"\n"}]:[{classNames:["user","error"],text:e+"\n"}]}c.setState((e=>({messages:e.messages.concat(n)})))}),[]),x=(0,n.useCallback)((()=>c.setState({messages:[]})),[]),k=(0,n.useMemo)((()=>d(v)),[]),O=(0,n.useMemo)((()=>d(b)),[]),C=(0,n.useMemo)((()=>d(w)),[]),j=(0,n.useMemo)((()=>d(x)),[]),S=(0,n.useMemo)((()=>({"Cmd-Enter":w,"Ctrl-Enter":w,"Cmd-K":x})),[]);return m.className||(m.className=""),m.className+=` rp-codebooth active-${g}`,n.createElement("div",Object.assign({},m),i?n.createElement(o.CodeEditor,{className:"code-playground",keyMap:S,mode:r,recorder:i,ref:y,theme:u}):n.createElement(n.Fragment,null,n.createElement(o.CodeReplay,{className:"code-replay",command:E,keyMap:S,mode:r,ref:f,replay:a,start:e.start,theme:u}),n.createElement(o.CodeEditor,{className:"code-playground",keyMap:S,mode:r,ref:y,theme:u})),n.createElement("div",{onMouseUp:s.Player.preventCanvasClick},n.createElement("button",Object.assign({className:"button-replay"},k),"Code"),n.createElement("button",Object.assign({className:"button-playground"},k),"Playground"),n.createElement("button",Object.assign({className:"button-copy"},O),"Copy"),n.createElement("button",Object.assign({className:"button-run"},C,{title:"Cmd+Enter"}),"Run"),n.createElement("button",Object.assign({className:"button-clear"},j,{title:"Cmd+K"}),"Clear")),n.createElement(p,null))}},316:(e,t,r)=>{var n=r(757),s=r(926),o=r(154);function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}i(n),i(s),i(o),t.$e=function(e,t){return function(r,n,s){return Object.assign({},e,t(r,n,s))}}},742:e=>{e.exports=s},576:e=>{e.exports=o},888:e=>{e.exports=n}},t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(996)})())},160:(e,t,r)=>{var n,s;self,e.exports=(n=r(363),s=r(341),(()=>{var e={838:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var n=r(888),s=r(576);const{replay:o}=s.Utils.animation,{between:i}=s.Utils.misc;function a(e){const{playback:t,script:r}=(0,s.usePlayer)(),a=n.useRef(),c=r.parseStart(e.start),l=r.parseEnd(e.end);n.useEffect((()=>{const{display:r}=a.current.style;a.current.style.display="block";const{height:n,width:s}=a.current.getBoundingClientRect();a.current.style.display=r;const i=o({data:e.replay,start:c,end:l,active:([e,t])=>{Object.assign(a.current.style,{opacity:1,left:`calc(${e}% - ${s/2}px)`,top:`calc(${t}% - ${n/2}px)`})},inactive:()=>{a.current.style.opacity="0"},compressed:!0});return t.hub.on("seek",i),t.hub.on("timeupdate",i),i(t.currentTime),()=>{t.hub.off("seek",i),t.hub.off("timeupdate",i)}}),[a.current]);const u={pointerEvents:"none",position:"absolute",zIndex:1e3};return i(c,t.currentTime,l)&&(u.opacity=0),n.createElement("img",{className:"rp-cursor",ref:a,src:e.src,style:u})}},576:e=>{e.exports=s},888:e=>{e.exports=n}},t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(838)})())},891:(e,t,r)=>{var n,s;self,e.exports=(n=r(363),s=r(341),(()=>{var e={829:(e,t,r)=>{r.r(t),r.d(t,{PaintCanvas:()=>re,PaintReplay:()=>me});var n=r(888),s=r(576);function o(e){const t={};for(let r in e)t[r]=e[r].current;return t}const i={type:"change-sheet",preprocess(e){return this.state.activeSheet=e.sheet,!0},process(e){const{state:t}=this;if(e.sheet>=this.state.numSheets&&(this.state.numSheets=e.sheet+1),e.sheet!==this.state.activeSheet){const[e,t]=this.consume({test:e=>"change-sheet"!==e.type})}return!0}},a={type:"clear",process(e){const{stable:t}=this.layers;return t.getContext("2d").clearRect(0,0,t.width,t.height),!0}},{ceil:c,floor:l,max:u,min:p}=Math,h={type:"set-stroke-style",process(e){for(const t of[this.contexts.stable,this.contexts.temp,this.state])t.strokeStyle=e.strokeStyle;return!0}},d={type:"move-to",process(e){const{lineWidth:t,strokeStyle:r}=this.state,[n,s]=this.consume({test:e=>"line-to"===e.type}),o=[[e.x,e.y],...n.map((e=>[e.x,e.y]))],i=s?this.layers.stable:this.layers.temp,a=i.getContext("2d"),{height:c,width:u}=i;if(a.lineJoin=a.lineCap="round",a.strokeStyle=r,a.lineWidth=t,1===o.length)a.fillStyle=r,a.fillRect(l(u*o[0][0]-t/2),l(c*o[0][1]-t/2),t,t);else{a.beginPath(),a.moveTo(l(o[0][0]*u),l(o[0][1]*c));for(let e=0,t=o.length;e<t-1;e++){const t=o[e],r=o[e+1],n=t[0]+(r[0]-t[0])/2,s=t[1]+(r[1]-t[1])/2;a.quadraticCurveTo(l(u*t[0]),l(c*t[1]),l(u*n),l(c*s))}a.stroke()}return s}},{ceil:m,floor:f,max:y,min:g}=Math,v={type:"erase",process(e){const t=this.layers.stable,r=t.getContext("2d");return r.save(),r.beginPath(),r.globalCompositeOperation="destination-out",r.arc(f(e.x*t.width),f(e.y*t.height),f(e.r*t.width),0,2*Math.PI),r.fill(),r.restore(),!0}},b={};for(const fe of[a,v,d,h,i])b[fe.type]=fe;class E{constructor(e={}){Object.assign(this,{complete:!0,i:0,index:0,state:{activeSheet:0,numSheets:1,lineWidth:2,strokeStyle:"#000000"}},e),this.contexts={},this.complete=!0}consume({test:e}){const t=[];for(;this.i+1<this.feed.length;++this.i){const r=this.feed[this.i+1];if(!e(r))return[t,!0];t.push(r)}return[t,this.complete]}preprocess(){this.complete=!1;let e=Object.keys(b).filter((e=>b[e].preprocess)).length;for(let t=this.feed.length-1;t>=0;--t){const r=this.feed[t];if(!b.hasOwnProperty(r.type))continue;const n=b[r.type];if(n.hasOwnProperty("preprocess")&&(n.preprocess.call(this,r)&&e--,0===e))break}}process(){for(;this.i<this.feed.length;++this.i){const e=this.feed[this.i];if(!b.hasOwnProperty(e.type))continue;const t=b[e.type];if(t.hasOwnProperty("process")){if(!t.process.call(this,e))break;this.index=this.i+1}}}record(e){this.feed.push(e)}reset(){this.index=0;for(const e in this.layers){const t=this.layers[e];t.getContext("2d").clearRect(0,0,t.width,t.height)}}repaint(e=!1){if(!this.contexts.hasOwnProperty("temp"))for(const t in this.layers)this.contexts[t]=this.layers[t].getContext("2d");e&&this.reset(),this.i=this.index,this.preprocess(),this.contexts.temp.clearRect(0,0,this.layers.temp.width,this.layers.temp.height),this.process()}}const w={name:"draw",down({consumer:e,layers:t,hit:r}){const n=t.stable.getBoundingClientRect(),s={type:"move-to",x:(r.x-n.left)/n.width,y:(r.y-n.top)/n.height};e.record(s),e.complete=!1,e.repaint()},move({consumer:e,layers:t,hit:r,record:n}){const s=t.stable.getBoundingClientRect(),o={type:"line-to",x:(r.x-s.left)/s.width,y:(r.y-s.top)/s.height};e.record(o),e.repaint()},up({consumer:e}){e.complete=!0,e.repaint()}},{floor:x}=Math,k={name:"eraser",hover({layers:e,hit:t}){const r=e.aid,n=r.getBoundingClientRect(),s=r.getContext("2d");s.clearRect(0,0,r.width,r.height),s.lineWidth=1,s.strokeStyle="#000",s.setLineDash([6,4]),s.beginPath(),s.arc(x(t.x-n.left),x(t.y-n.y),x(.02*n.width),0,2*Math.PI),s.stroke()},down({consumer:e,layers:t,hit:r,record:n}){const s=t.stable.getBoundingClientRect(),o={type:"erase",x:(r.x-s.left)/s.width,y:(r.y-s.top)/s.height,r:.02};e.record(o),e.repaint()},move({consumer:e,layers:t,hit:r}){const n=t.stable.getBoundingClientRect(),s={type:"erase",x:(r.x-n.left)/n.width,y:(r.y-n.top)/n.height,r:.02};e.record(s),e.repaint()}},O=n.createElement("g",{fill:"#fff"},n.createElement("path",{d:"m23.2859 93.4398c-.0321-.002-.0563-.0008-.0887-.0029-.3133-.0198-.6378-.0447-.9657-.0753-.328-.0306-.6593-.0666-.9909-.1101-.3318-.0435-.6632-.0936-.988-.1521s-.644-.1257-.951-.2014c-.307-.0756-.6014-.16-.88-.2549-.1392-.0475-.275-.098-.4052-.1507-.1301-.0527-.2545-.1084-.3742-.1666-.1196-.0582-.2338-.1186-.3416-.1826-.1079-.0639-.2101-.1313-.3047-.2013s-.1816-.1425-.2618-.2187c-.0801-.0763-.1531-.1562-.2173-.239l-.1672-.2593c-.047-.0898-.0854-.1829-.1138-.2797-.0286-.0967-.0477-.1972-.0563-.3013-.0085-.1041-.0067-.2113.006-.323.0127-.1118.018-.222.0147-.3289-.0031-.1069-.0145-.2107-.0325-.3129-.018-.102-.0434-.201-.0754-.2984s-.0705-.1925-.1154-.2854c-.0448-.0928-.0956-.1841-.1523-.2724-.0567-.0882-.1187-.1739-.1863-.2578s-.1415-.1652-.2189-.2448c-.0775-.0796-.1592-.158-.2455-.2332-.0864-.0753-.1764-.1477-.2708-.2188-.0942-.0711-.1931-.1401-.2943-.2072-.0419-.0278-.09-.051-.1331-.0782-1.5258 3.321-3.9582 5.3779-8.95801 6.29-.81882.1494-.54858 1.1271 0 1.1271 5.90331 0 12.69441-.0272 17.76821-1.5602z"}),n.createElement("path",{d:"m23.147 78.0639c-3.7321 0-6.8361 2.6364-7.4747 6.1118-.3443 1.2582-.7294 2.3904-1.1966 3.4072.0432.0271.0912.0504.1332.0782.1011.0671.2.136.2943.2072.0943.0711.1843.1435.2707.2187.0863.0752.168.1537.2455.2333.0774.0795.1513.1609.2189.2448s.1296.1696.1863.2578c.0567.0883.1075.1796.1523.2724.0449.0928.0834.188.1154.2854.032.0973.0574.1963.0754.2984s.0294.206.0325.3128c.0033.107-.002.2171-.0147.3289s-.0145.219-.006.3231c.0086.1041.0277.2045.0563.3013.0284.0968.0668.1899.1138.2796.047.0896.1029.1765.1672.2593.0642.0828.1372.1628.2173.239.0802.0763.1672.1488.2618.2188.0946.0699.1969.1373.3047.2013s.222.1243.3416.1825c.1197.0583.2441.1139.3742.1666.1302.0528.266.1033.4052.1507.2786.0949.573.1793.88.255.307.0756.6262.1428.951.2013s.6563.1087.988.1521c.3316.0435.6629.0795.9909.1101.3279.0306.6524.0556.9657.0754.0324.002.0566.0009.0887.0028 2.9268-.8843 5.2842-2.267 6.5652-4.4401.5674-1.0421.8888-2.2334.8888-3.497 0-4.1084-3.3986-7.4388-7.5929-7.4388z"}),n.createElement("path",{d:"m71.302 5.00013c-.1587.0034-.3394.07411-.5029.28538-.232.31688-30.4484 41.40919-37.3275 53.54479.164.0523.332.1059.5014.1651 1.0616.3707 2.235.8774 3.4873 1.5674 1.4894.8207 3.0912 1.9006 4.7534 3.3159 7.5537-11.9997 29.4184-57.63808 29.5882-57.99055.1568-.39472.0022-.67845-.1582-.78806-.0101-.00685-.0209-.01359-.0326-.02029-.0764-.04393-.1857-.08232-.3091-.07967z"}),n.createElement("path",{d:"m32.6403 60.3861c-.1163.2378-.2152.4547-.2957.6475-2.5564 6.1258-6.3889 13.48-7.4496 16.2842 2.033.308 3.799 1.4052 4.962 2.9625 1.9802-2.2656 6.6581-9.0957 10.8541-14.2271.1599-.1956.338-.4317.5309-.7041-1.5083-1.3064-2.9557-2.3097-4.2979-3.0783-1.2986-.7438-2.4989-1.2688-3.5657-1.6414-.2549-.089-.5-.1709-.7381-.2433z"}));function C(){return n.createElement("svg",{viewBox:"0 0 75 75"},n.createElement("g",{transform:"translate(0, 45) rotate(-40) translate(-31.543342,-132.63477)"},n.createElement("path",{fill:"#CCC",stroke:"#000",strokeLinejoin:"round",strokeMiterlimit:"4",d:"m 36.072339,133.16377 h 31.680484 v 32.87415 H 36.072339 c -2.215998,0 -3.999997,-1.784 -3.999997,-4 v -24.87415 c 0,-2.216 1.783999,-4 3.999997,-4 z"}),n.createElement("path",{fill:"#D34A4A",stroke:"#000",strokeLinejoin:"round",strokeMiterlimit:"4",d:"m 67.752823,133.16377 h 31.680483 c 2.216004,0 3.999994,1.784 3.999994,4 v 24.87415 c 0,2.216 -1.78399,4 -3.999994,4 H 67.752823 Z"})))}function j(){return n.createElement("svg",{viewBox:"0 0 100 100"},n.createElement("rect",{x:"10",y:"40",height:"50",width:"50",rx:"15",ry:"15",fill:"none",stroke:"#FFF",strokeWidth:"3"}),n.createElement("rect",{x:"40",y:"10",height:"50",width:"50",rx:"15",ry:"15",fill:"none",stroke:"#FFF",strokeWidth:"3"}))}const{onClick:S}=s.Utils.mobile,P=68;function R(e){const{dispatch:t,$state:r}=(0,n.useContext)(ee);(0,n.useEffect)((()=>{e.listen((e=>{e.altKey&&e.keyCode===P&&(e.preventDefault(),e.stopPropagation(),t({type:"set-tool",name:"draw"}))}))}),[]);const s=["rp-paint-tool"];"draw"===r.current.tool&&s.push("selected");const o=(0,n.useMemo)((()=>S((()=>{t({type:"set-tool",name:"draw"})}))),[]);return n.createElement("button",Object.assign({className:s.join(" ")},o),n.createElement("svg",{viewBox:"0 0 100 100"},O))}const{onClick:M}=s.Utils.mobile,U=67,N=69;function L(e){const{consumer:t,dispatch:r,$state:s}=(0,n.useContext)(ee);(0,n.useEffect)((()=>{e.listen((e=>{e.altKey&&!e.metaKey&&e.keyCode===N?(e.preventDefault(),e.stopPropagation(),r({type:"set-tool",name:"eraser"})):e.altKey&&!e.metaKey&&e.keyCode===U&&(e.preventDefault(),e.stopPropagation(),t.record({type:"clear"}),t.repaint())}))}),[]);const o=["rp-paint-tool"];"eraser"===s.current.tool&&o.push("selected");const i=(0,n.useMemo)((()=>M((()=>{r({type:"set-tool",name:"eraser"})}))),[]);return n.createElement("button",Object.assign({className:o.join(" ")},i),n.createElement(C,null))}const{between:T}=s.Utils.misc,{onClick:$}=s.Utils.mobile;function D(e){const[t,r]=(0,n.useState)(!1),{consumer:s,$state:o,dispatch:i}=(0,n.useContext)(ee),a=o.current,c=(0,n.useRef)(["#ffffff","#ff0000","#1a69b5","#008000","#ae81ff","#ff8000","#ff0080"]),[l,u]=(0,n.useState)(c.current);c.current=l,(0,n.useEffect)((()=>{e.listen((e=>{if(e.altKey&&!e.metaKey&&T(49,e.keyCode,49+l.length)){e.preventDefault(),e.stopPropagation();const t={type:"set-stroke-style",strokeStyle:c.current[e.keyCode-49]};s.record(t),i(t)}else e.altKey&&"h"===e.key&&document.querySelectorAll(".rp-paint-replay")}))}),[]);const p=(0,n.useMemo)((()=>$((()=>{r((e=>!e))}))),[]),h=(0,n.useMemo)((()=>({onChange:e=>{const t=e.currentTarget.value,r=e.currentTarget.name.match(/^palette-(\d+)$/)[1];u((e=>{const n=e.slice();return n[r]=t,n}))}})),[]);return n.createElement(n.Fragment,null,n.createElement("aside",{className:"rp-paint-palette",style:{display:t?"block":"none"}},l.map(((e,t)=>n.createElement("div",{className:"rp-paint-color",key:t},n.createElement("input",Object.assign({},h,{name:`palette-${t}`,type:"color",value:e})),n.createElement("kbd",null,t+1))))),n.createElement("button",Object.assign({className:"rp-paint-tool rp-paint-format"},p,{style:{backgroundColor:a.strokeStyle}})))}const{range:_}=s.Utils.misc,{onClick:H}=s.Utils.mobile;function A(e){const{consumer:t}=(0,n.useContext)(ee),[r,s]=(0,n.useState)(!1),o=(0,n.useRef)([]);(0,n.useEffect)((()=>{e.listen((e=>{if(e.altKey)if("ArrowDown"===e.key){o.current[t.state.activeSheet]=t.layers.stable.toDataURL();const e={type:"change-sheet",sheet:t.state.activeSheet+1};t.record(e),t.repaint(!0)}else if("ArrowUp"===e.key){if(0===t.state.activeSheet)return;o.current[t.state.activeSheet]=t.layers.stable.toDataURL();const e={type:"change-sheet",sheet:t.state.activeSheet-1};t.record(e),t.repaint(!0)}}))}),[]);const i=(0,n.useMemo)((()=>H((()=>{s((e=>(e||(o.current[t.state.activeSheet]=t.layers.stable.toDataURL()),!e)))}))),[]);return n.createElement(n.Fragment,null,n.createElement("aside",{className:"rp-sheets-dialog",style:{display:r?"block":"none"}},n.createElement("ol",null,_(t.state.numSheets).map((e=>n.createElement("li",{className:e===t.state.activeSheet?"selected":"",key:e},n.createElement("img",{src:o.current[e]})))))),n.createElement("button",Object.assign({className:["rp-paint-tool"].join(" ")},i),n.createElement(j,null)))}const{replay:F}=s.Utils.animation,{dragHelperReact:B}=s.Utils.interactivity,{between:z}=s.Utils.misc,{onClick:W}=s.Utils.mobile;function K(){const{consumer:e}=(0,n.useContext)(ee),t=((0,n.useContext)(s.Player.Context),(0,n.useRef)()),[r,o]=(0,n.useState)(!1),i=(0,n.useRef)([]),a=(0,n.useCallback)((e=>{i.current.push(e)}),[]);(0,n.useEffect)((()=>{const r=r=>{if("p"===r.key)return o((e=>!e));"h"===r.key?I(t.current,".rp-paint-canvas-container").classList.toggle("visible"):"z"===r.key&&r.metaKey&&e.record({type:"undo"});for(const e of i.current)e(r)};return document.body.addEventListener("keydown",r),()=>{document.body.removeEventListener("keydown",r)}}),[r]);const c=(0,n.useMemo)((()=>{let e,r;return B(((n,s)=>{const o=function(e){if(void 0!==e.offsetLeft&&void 0!==e.offsetTop)return{left:e.offsetLeft,top:e.offsetTop,width:e.offsetParent.getBoundingClientRect().width,height:e.offsetParent.getBoundingClientRect().height};const t=e.getBoundingClientRect();let r=e;for(;r=r.parentNode;){if(!["absolute","relative"].includes(getComputedStyle(r).position))continue;const e=r.getBoundingClientRect();return{left:t.left-e.left,top:t.top-e.top,width:e.width,height:e.height}}return{left:t.left,top:t.top,width:innerWidth,height:innerHeight}}(t.current),i=o.left+s.x-e,a=o.top+s.y-r,c=i/o.width*100,l=a/o.height*100;e=s.x,r=s.y,Object.assign(t.current.style,{left:`${c}%`,top:`${l}%`})}),((t,n)=>{e=n.x,r=n.y}))}),[]);return n.createElement("aside",{className:"rp-paint-settings",ref:t,style:{display:r?"block":"none"}},n.createElement("div",Object.assign({className:"rp-paint-drag-handle"},c)),n.createElement(R,Object.assign({},{listen:a})),n.createElement(L,Object.assign({},{listen:a})),n.createElement(D,Object.assign({},{listen:a})),n.createElement(A,Object.assign({},{listen:a})))}function I(e,t){if(e)return e.matches(t)?e:I(e.parentNode,t)}const{replay:q}=s.Utils.animation,{dragHelperReact:G}=s.Utils.interactivity,{between:V}=s.Utils.misc,J={draw:w,eraser:k},Y={tool:"draw",strokeStyle:"#000000",lineWidth:2},{floor:Z,max:Q,min:X}=Math,ee=n.createContext(null);function te(e,t){switch(t.type){case"set-stroke-style":return Object.assign(Object.assign({},e),{strokeStyle:t.strokeStyle});case"set-tool":return Object.assign(Object.assign({},e),{tool:t.name})}return e}function re(e){const t=(0,n.useRef)([]),r={aid:(0,n.useRef)(),stable:(0,n.useRef)(),temp:(0,n.useRef)()},[s,i]=(0,n.useReducer)(te,Y),a=(0,n.useRef)(Y);a.current=s;const c=(0,n.useRef)(new E({feed:t.current,record(t){var r;null===(r=e.recorder)||void 0===r||r.captureAction(t),this.feed.push(t)}})),l=c.current,u={consumer:c.current,dispatch:i,layers:o(r),$state:a},p=(0,n.useMemo)((()=>Object.assign({onMouseMove:e=>{var t;const n=J[a.current.tool];null===(t=n.hover)||void 0===t||t.call(n,{layers:o(r),hit:{x:e.clientX,y:e.clientY}})}},G(((e,t)=>{var n;const s=J[a.current.tool];null===(n=s.move)||void 0===n||n.call(s,{e,hit:t,consumer:l,layers:o(r)})}),((e,t)=>{var n;const s=J[a.current.tool];null===(n=s.down)||void 0===n||n.call(s,{e,hit:t,consumer:l,layers:o(r),state:a.current})}),(e=>{var t;const n=J[a.current.tool];null===(t=n.up)||void 0===t||t.call(n,{e,consumer:l,layers:o(r)})})))),[]);return n.useEffect((()=>{function e(){for(const e in r){const t=r[e].current,n=t.getBoundingClientRect();t.height=n.height,t.width=n.width}l.repaint(!0)}return l.layers=o(r),window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}}),[r.temp.current,r.stable.current]),n.createElement("div",{className:"rp-paint-canvas-container"},n.createElement(ee.Provider,{value:u},n.createElement("canvas",{id:"stable",className:"rp-paint-layer noinput",ref:r.stable}),n.createElement("canvas",Object.assign({id:"temp",className:"rp-paint-layer"},p,{ref:r.temp})),n.createElement("canvas",{className:"rp-paint-layer noinput",ref:r.aid}),n.createElement(K,null)))}const{ceil:ne,floor:se,max:oe,min:ie}=Math;function ae({action:e,consume:t,stable:r,state:n,temp:s}){const{lineWidth:o,strokeStyle:i}=n,a=r.getContext("2d"),c=s.getContext("2d");switch(e.type){case"change-sheet":return e.sheet>=n.sheets.length&&(n.sheets.length=e.sheet),e.sheet!==n.activeSheet&&a.clearRect(0,0,r.width,r.height),n.activeSheet=e.sheet,!0;case"set-stroke-style":return a.strokeStyle=n.strokeStyle=c.strokeStyle=e.strokeStyle,!0;case"clear":return a.clearRect(0,0,r.width,r.height),!0;case"erase":{const t=r.getContext("2d");return t.save(),t.beginPath(),t.globalCompositeOperation="destination-out",t.arc(se(e.x*r.width),se(e.y*r.height),se(e.r*r.width),0,2*Math.PI),t.fill(),t.restore(),!0}case"move-to":const[l,u]=t({test:e=>"line-to"===e.type}),p=[[e.x,e.y],...l.map((e=>[e.x,e.y]))],h=u?r:s,d=h.getContext("2d"),{height:m,width:f}=h;if(d.lineJoin=d.lineCap="round",d.strokeStyle=n.strokeStyle,d.lineWidth=n.lineWidth,1===p.length)d.fillStyle=i,d.fillRect(se(f*p[0][0]-o/2),se(m*p[0][1]-o/2),o,o);else{d.beginPath(),d.moveTo(se(p[0][0]*f),se(p[0][1]*m));for(let e=0,t=p.length;e<t-1;e++){const t=p[e],r=p[e+1],n=t[0]+(r[0]-t[0])/2,s=t[1]+(r[1]-t[1])/2;d.quadraticCurveTo(se(f*t[0]),se(m*t[1]),se(f*n),se(m*s))}d.stroke()}return u}}const{replay:ce}=s.Utils.animation,{between:le}=s.Utils.misc,{floor:ue,max:pe,min:he}=Math,de={activeSheet:0,strokeStyle:"#000",lineWidth:2,sheets:[]};function me(e){var t;const{playback:r,script:o}=(0,s.usePlayer)(),i=(0,n.useRef)(null!==(t=e.replay)&&void 0!==t?t:[]),a=(0,n.useRef)(de),c=((0,n.useRef)([{type:"change-sheet",sheet:0},{type:"set-stroke-style",strokeStyle:"#FFF"}]),{stable:(0,n.useRef)(),temp:(0,n.useRef)()});return n.useEffect((()=>{var t;const n=null!==(t=o.parseStart(e.start))&&void 0!==t?t:0;let s=r.currentTime,l=0,u=0;function p(e=r.currentTime,t=!1){const o=c.stable.current,h=o.getContext("2d"),d=c.temp.current,m=d.getContext("2d"),{lineWidth:f,strokeStyle:y}=a.current;if((e<s||t)&&(l=0,u=0,h.clearRect(0,0,o.width,o.height)),s=e,a.current.repaint=p,m.clearRect(0,0,d.width,d.height),e<n)return;let g=l,v=u,b=null,E=null,w=g;for(;g<i.current.length;++g){const[t,r]=i.current[g];if(v+=t,e<=n+v)break;w=g+1,"set-stroke-style"===r.type?E=g:"change-sheet"===r.type&&(b=g,u=v-t)}function x({test:e}){const t=[];for(;g+1<w;++g){const[r,n]=i.current[g+1];if(!e(n))return[t,!0];v+=r,t.push(n)}return[t,w===i.current.length]}for(null!==b&&(l=b,null!==E&&ae({action:i.current[E][1],consume:x,stable:o,state:a.current,temp:d})),g=l,v=u;g<w;++g){const[e,t]=i.current[g];if(v+=e,!ae({action:t,consume:x,stable:o,state:a.current,temp:d}))break;l=g+1,u=v}}function h(){const e=c.stable.current.getBoundingClientRect();c.temp.current.height=c.stable.current.height=e.height,c.temp.current.width=c.stable.current.width=e.width,p(r.currentTime,!0)}return window.addEventListener("resize",h),r.hub.on("seek",p),r.hub.on("timeupdate",p),h(),()=>{window.removeEventListener("resize",h),r.hub.off("seek",p),r.hub.off("timeupdate",p)}}),[c.stable.current,c.temp.current]),n.createElement("div",{className:"rp-paint-view"},n.createElement("canvas",{className:"rp-paint-layer noinput",ref:c.temp}),n.createElement("canvas",{className:"rp-paint-layer noinput",ref:c.stable}))}},576:e=>{e.exports=s},888:e=>{e.exports=n}},t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(829)})())},881:e=>{e.exports=Liqvid},341:e=>{e.exports=RactivePlayer},363:e=>{e.exports=React}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=r(363);const t=ReactDOM;var n=r(881);const{timeRegexp:s}=n.Utils.time,o=new RegExp("(?:^\\?|&)t=("+s.toString().replace(/^\/\^|\$\/$/g,"")+")"),i="https://d2og9lpzrymesl.cloudfront.net/r/lv-tutorial",a=[["intro/","0:20.955"],["intro/fiddle","0:10.532"],["intro/pause","0:02.86"],["intro/pros","0:07.839"],["intro/edit","0:23.233"],["intro/epiplexis","0:13.506"],["intro/get-started","0:10.553"],["intro/discord","0:18.732"],["codemirror/","1:17.46"],["cursor/","0:19.917"],["paint/","0:41.562"],["playback/","0:05.529"],["playback/loop","0:06.91"],["playback/html","0:11.408"],["playback/hub","0:18.520"],["script/","0:06.785"],["script/markers","0:18.733"],["script/repeat","0:04.978"],["script/ew","0:13.193"],["player/","0:07.99"],["player/gui","0:04.626"],["player/react","0:22.742"],["player/hook","0:12.14"],["utils/","0:10.142"],["utils/animate","0:06.258"],["utils/animate/fire","0:02.996"],["utils/authoring","0:32.398"],["utils/drag","0:16.945"],["recording/","0:09.351"],["recording/npm","0:04.425"],["recording/control","0:09.547"],["recording/https","0:09.489"],["recording/link","0:05.975"],["recording/plugin","0:12.37"]],c={"dfn-ractives":{"data-from-first":"intro/ractives",style:{color:"#333",fontFamily:"Alegreya",fontSize:"2rem",left:"51%",position:"absolute",top:"29%"}},"diamond-age":{"data-during":"intro/diamond-age",style:{height:"50%",left:"70%",position:"absolute",top:"35%"}}};var l=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]])}return r};function u(t){const{children:r}=t,n=l(t,["children"]);return e.createElement("a",Object.assign({target:"_blank"},n),r)}const p=()=>null,h=()=>null,d=()=>null,m=()=>null,f=()=>null,y=()=>null,g=()=>null,v=()=>null,b=()=>null,{during:E,from:w}=n.Utils.authoring,{between:x}=n.Utils.misc;function k(){const t=(0,n.usePlayer)(),r=(0,e.useCallback)((e=>{t.canvas.style.backgroundColor=e.currentTarget.value}),[]),[s,o]=(0,e.useState)("A library for interactive videos in HTML/CSS/JS"),a=(0,e.useCallback)((e=>{o(e.currentTarget.value)}),[]),c=e.useMemo((()=>t.script.parseStart("intro/pause")),[]),l=e.useRef(t.playback.currentTime);return(0,n.useTimeUpdate)((e=>{x(c-300,l.current,c)&&x(c,e,c+300)&&t.playback.pause(),l.current=e}),[]),e.createElement(n.IdMap,null,e.createElement("section",Object.assign({id:"sec-intro"},E("intro/")),e.createElement("h1",null,e.createElement("img",{alt:"Liqvid",src:`${i}/img/logo.png`}),"Liqvid"),e.createElement("h2",null,s),e.createElement("div",Object.assign({className:"box",id:"fiddle"},w("intro/fiddle"),{onMouseUp:n.Player.preventCanvasClick}),e.createElement("p",null,"Try changing the background color:",e.createElement("input",{onChange:r,type:"color"})),e.createElement("p",null,"Or the subtitle:"),e.createElement("textarea",{onBlur:t.resumeKeyCapture,onFocus:t.suspendKeyCapture,onChange:a,value:s})),e.createElement("div",Object.assign({className:"box"},w("intro/pros")),e.createElement("p",null,"Much smaller than a traditional video file"),e.createElement("p",Object.assign({},w("intro/edit")),"Very easy to make edits—no waiting for video export"),e.createElement("p",Object.assign({},w("intro/epiplexis")),"More examples at ",e.createElement(u,{href:"https://epiplexis.xyz"},"Epiplexis"))),e.createElement("div",Object.assign({className:"box",id:"get-started"},w("intro/get-started")),e.createElement("p",null,"Clone this tutorial: ",e.createElement(u,{href:"https://github.com/ysulyma/lv-tutorial"},"https://github.com/ysulyma/lv-tutorial")),e.createElement("p",Object.assign({},w("intro/discord")),"Discussion: ",e.createElement(u,{href:"https://discord.gg/u8Qab99zHx"},"https://discord.gg/u8Qab99zHx"))),e.createElement(p,null)))}var O=r(212);class C{read(e){}async run(e){try{return this.runSync(e)}catch(t){throw t}}runSync(e){const t=["window","print","document"],r=[];return new Function("console",...t,e)(new j(r),...new Array(t.length)),r}}class j{constructor(e){this.output=e}log(...e){this.output.push(e.map((e=>void 0===e?e:`${e}`)).join(" ")+"\n")}}const{during:S}=n.Utils.authoring,{dragHelperReact:P}=n.Utils.interactivity,{constrain:R}=n.Utils.misc,{onClick:M}=n.Utils.mobile;function U(){const t=(0,e.useRef)();return t.current||(t.current=new C),e.createElement("section",Object.assign({id:"sec-codemirror"},S("codemirror/")),e.createElement(O.CodeBooth,{interpreter:t.current,mode:"javascript",replay:window.recordings.code,start:"codemirror/",theme:"monokai"}),e.createElement(h,null))}var N=r(160),L=r.n(N);const{during:T}=n.Utils.authoring;function $(){return e.createElement("section",Object.assign({id:"sec-cursor"},T("cursor/")),e.createElement("p",null,"The ",e.createElement(u,{href:"https://www.npmjs.com/package/rp-cursor"},"rp-cursor")," package lets you record mouse movements, in case you want to point to something on the screen."),e.createElement(L(),{src:`${i}/img/cursor.png`,start:"cursor/",end:"paint/",replay:window.recordings.cursor}),e.createElement(d,null))}var D=r(891);const{animate:_}=n.Utils.animation,{during:H}=n.Utils.authoring;function A(){return e.createElement("section",Object.assign({id:"sec-paint"},H("paint/")),e.createElement(D.PaintReplay,{replay:window.recordings.paint,start:"paint/"}),e.createElement(m,null))}const{during:F,from:B}=n.Utils.authoring;function z(){return e.createElement("section",Object.assign({id:"sec-playback"},F("playback/")),e.createElement("h2",null,"Playback"),e.createElement("ul",null,e.createElement("li",Object.assign({},B("playback/loop")),"animation loop simulating a media element advancing in time"),e.createElement("li",Object.assign({},B("playback/html")),"imitates (but does not fully implement) the ",e.createElement(u,{href:"https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement"},"HTMLMediaElement")," interface"),e.createElement("li",Object.assign({},B("playback/hub")),"emits events through ",e.createElement(u,{href:"https://nodejs.org/api/events.html#events_class_eventemitter"},"EventEmitter")," ",e.createElement("code",null,"playback.hub"))),e.createElement(f,null))}const{during:W,from:K}=n.Utils.authoring;function I(){return e.createElement("section",Object.assign({id:"sec-script"},W("script/")),e.createElement("h2",null,"Script"),e.createElement("ul",null,e.createElement("li",Object.assign({},K("script/markers")),"partitions a Playback into named segments called ",e.createElement("dfn",null,"markers")),e.createElement("li",Object.assign({},K("script/repeat")),"markers can repeat (experimental), cannot overlap"),e.createElement("li",Object.assign({},K("script/ew")),"press ",e.createElement("kbd",null,"E")," to advance a marker, ",e.createElement("kbd",null,"W")," to go back one marker")),e.createElement(y,null))}const{during:q,from:G}=n.Utils.authoring;function V(){return e.createElement("section",Object.assign({id:"sec-player"},q("player/")),e.createElement("h2",null,"Player"),e.createElement("ul",null,e.createElement("li",Object.assign({},G("player/gui")),"GUI: scrubber bar, controls, bells, whistles"),e.createElement("li",Object.assign({},G("player/react")),"depends on React (",e.createElement("code",null,"Playback")," and ",e.createElement("code",null,"Script")," do not!)"),e.createElement("li",Object.assign({},G("player/hook")),"access with ",e.createElement("code",null,"usePlayer()"))),e.createElement(g,null))}var J=r(534);const{animate:Y}=n.Utils.animation,{during:Z,from:Q}=n.Utils.authoring,{dragHelperReact:X}=n.Utils.interactivity,{constrain:ee}=n.Utils.misc,te=[.47,0,.745,.715];function re(){const t=(0,n.usePlayer)(),r=(0,e.useRef)(),s=(0,e.useMemo)((()=>Y({endValue:2*Math.PI,startTime:t.script.parseStart("utils/animate/fire"),duration:1e3,easing:J(...te)})),[]);(0,n.useTimeUpdate)((e=>{const t=s(e);r.current.style.left=35+15*Math.cos(t)+"%",r.current.style.top=15-12.5*Math.sin(t)+"%"}),[]);const o=(0,e.useRef)(),a=(0,e.useRef)({x:0,y:0}),c=(0,e.useMemo)((()=>X(((e,r)=>{const n=ee(0,r.x-a.current.x-t.canvas.offsetLeft,t.canvas.offsetWidth-o.current.offsetWidth)/t.canvas.offsetWidth,s=ee(0,r.y-a.current.y-t.canvas.offsetTop,t.canvas.offsetHeight-o.current.offsetHeight)/t.canvas.offsetHeight;Object.assign(o.current.style,{left:100*n+"%",top:100*s+"%"})}),((e,t)=>{e.preventDefault();const r=o.current.getBoundingClientRect();a.current.x=t.x-r.left,a.current.y=t.y-r.top,document.body.classList.add("dragging")}),(()=>{document.body.classList.remove("dragging")}))),[]);return e.createElement("section",Object.assign({id:"sec-utils"},Z("utils/")),e.createElement("h2",null,"Utils"),e.createElement("ul",null,e.createElement("li",Object.assign({},Q("utils/animate")),e.createElement("code",null,"Utils.animation.animate"),e.createElement("img",{id:"utils-duck",src:`${i}/img/duck.svg`,ref:r})),e.createElement("li",Object.assign({},Q("utils/authoring")),e.createElement("code",null,"Utils.authoring.{during, from}")),e.createElement("li",Object.assign({},Q("utils/drag")),e.createElement("code",null,"Utils.interactivity.dragHelperReact"),e.createElement("img",Object.assign({className:"draggable",id:"utils-pig",src:`${i}/img/pig.svg`,ref:o},c)))),e.createElement(b,null))}const{during:ne,from:se}=n.Utils.authoring;function oe(){return e.createElement("section",Object.assign({id:"sec-recording"},ne("recording/")),e.createElement("h2",null,"Recording"),e.createElement("ul",null,e.createElement("li",Object.assign({},se("recording/npm")),"recording functionality provided by ",e.createElement(u,{href:"https://www.npmjs.com/package/rp-recording"},"rp-recording")),e.createElement("li",Object.assign({},se("recording/control")),"implemented as custom control, c.f. ",e.createElement("code",null,"index.tsx")),e.createElement("li",Object.assign({},se("recording/https")),"can only record audio over HTTPS!",e.createElement(u,Object.assign({id:"recording-https-link"},se("recording/link"),{href:"https://www.freecodecamp.org/news/how-to-get-https-working-on-your-local-development-environment-in-5-minutes-7af615770eec/"}),"How to get HTTPS working on your local development environment")),e.createElement("li",Object.assign({},se("recording/plugin")),"plugin API")),e.createElement(v,null))}t.render(e.createElement((function(){const t=e.useRef();e.useEffect((()=>{const e=t.current;(e=>{const{keymap:t,script:r}=e;for(const n of t.getHandlers("ArrowLeft"))t.unbind("ArrowLeft",n);for(const n of t.getHandlers("ArrowRight"))t.unbind("ArrowRight",n);t.bind("ArrowRight",r.forward)})(e),e.canPlay.then((()=>{(e=>{const t=parent.location.search.match(o);t&&e.seek(t[1])})(e.playback),e.ready()}))}),[]);const r=new n.Script(a),s=r.parseStart,l=[{title:"Codebooth",time:s("codemirror/")},{title:"Cursor",time:s("cursor/")},{title:"Paint",time:s("paint/")},{title:"Playback",time:s("playback/")},{title:"Script",time:s("script/")},{title:"Player",time:s("player/")},{title:"Utils",time:s("utils/")},{title:"Recording",time:s("recording/")}],u={cols:5,rows:5,height:100,width:160,frequency:1,path:`${i}/thumbs/%s.png`,highlights:l};return e.createElement(n.Player,{controls:undefined,ref:t,script:r,thumbs:u},e.createElement(n.IdMap,{map:c},e.createElement(n.Audio,{start:0},e.createElement("source",{src:`${i}/audio/audio.webm`,type:"audio/webm"}),e.createElement("source",{src:`${i}/audio/audio.mp4`,type:"audio/mp4"})),e.createElement(k,null),e.createElement(U,null),e.createElement($,null),e.createElement(A,null),e.createElement(z,null),e.createElement(I,null),e.createElement(V,null),e.createElement(re,null),e.createElement(oe,null)))}),null),document.querySelector("main"))})()})();